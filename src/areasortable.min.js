/**
*  area-sortable.js
*  A simple js class to sort elements of an area smoothly using drag-and-drop (desktop and mobile)
*  @VERSION: 1.2.0
*
*  https://github.com/foo123/area-sortable.js
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.AreaSortable=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var X="$areaSortable",Y="rect",q="style",G="margin",J="padding",K="left",Q="right",U="width",Z="top",_="bottom",tt="height",et="nextElementSibling",nt="previousElementSibling",ot="scrollTop",rt="scrollLeft",it=1,at=2,lt=it+at,st=Math,pt=String,ct=parseInt,o=Object.prototype.hasOwnProperty,e=/^\s+|\s+$/g,ut=/mousedown|pointerdown/,n=pt.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},r=null;function i(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function dt(t){return t<0?-1:0<t?1:0}function ft(t,e){return t.classList?t.classList.contains(e):-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function mt(t,e){t.classList?t.classList.add(e):ft(t,e)||(t.className=""===t.className?e:t.className+" "+e)}function ht(t,e){t.classList?t.classList.remove(e):t.className=n((" "+t.className+" ").replace(" "+e+" "," "))}function vt(t,e,n,o){null==r&&(r=i()),t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,r?o:"object"==typeof o?!!o.capture:!!o)}function gt(t,e,n,o){null==r&&(r=i()),t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener(e,n,r?o:"object"==typeof o?!!o.capture:!!o)}function xt(t){return("function"==typeof window.getComputedStyle?window.getComputedStyle(t):t.currentStyle)||{}}function bt(t,e,n){return t.elementsFromPoint(e,n)}function wt(n,t){return t.reduce(function(t,e){return t[e]=n[q].getPropertyValue(e),t},{})}function yt(e,t,n){n=n||e[X][q],t.forEach(function(t){o.call(n,t)&&""!==n[t]?e[q][t]=n[t]:e[q].removeProperty(t)})}function Et(e,t,n){var o,r,i,a;return 0<t&&(e[X]&&e[X].animation&&e[X].animation.stop(),o="transform "+pt(t)+"ms",r="translate3d(0,0,0)",i=null,a=function t(){i&&clearTimeout(i),i=null,e[X]&&e[X].animation&&t===e[X].animation.stop&&(e[X].animation=null),e[q].transform===r&&e[q].transition===o&&(e[q].transition="none",e[q].transform="none")},e[q].transition="none",e[q].transform="translate3d("+pt(-(n[K]||0))+"px,"+pt(-(n[Z]||0))+"px,0)",e.offsetWidth,e[q].transform=r,e[q].transition=o,i=setTimeout(a,t),e[X].animation={stop:a}),e}function Tt(t,e,n,o,r){t=t[X].r,e=e[X][Y];return st.max(0,st.min(1,st.max(0,st.min(t[o]+t[r],e[o]-n[o]+e[r])-st.max(t[o],e[o]-n[o]))/st.min(t[r],e[r])))}function Lt(t,e,n,o,r){var i=t[X].r,a=e[X][Y],t=0,e=0,t=st.max(0,st.min(i[K]+i[U],a[K]-n[K]+a[U])-st.max(i[K],a[K]-n[K])),e=st.max(0,st.min(i[Z]+i[tt],a[Z]-n[Z]+a[tt])-st.max(i[Z],a[Z]-n[Z]));return st.max(0,st.min(1,t*e/(st.min(i[U],a[U])*st.min(i[tt],a[tt]))))}function St(t,e){return 0!==t[e]||((t[e]=1)===t[e]?(t[e]=0,1):void 0)}function a(w,y){function n(){$=u=c=d=f=P=C=N=I=S=L=e=T=E=null,W=!1,O=0}function o(){m&&(D&&(clearInterval(D),D=null),h?(gt($,"touchmove",x,!1),gt($,"touchend",b,!1),gt($,"touchcancel",b,!1)):(gt($,"mousemove",x,!1),gt($,"mouseup",b,!1)),E&&E.parentNode&&(E.parentNode.removeChild(E),E[X]=null),N&&(N[X]=null),C[X]=null,ht(C,w.opts.activeArea||"dnd-sortable-area"),yt(C,["width","height","box-sizing"],f),L&&ht(L,w.opts.closestItem||"dnd-sortable-closest"),ht(T,w.opts.activeItem||"dnd-sortable-dragged"),c.forEach(function(t){yt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),t[X]=null}),m=!1)}function p(t,e,n){n<0?(S===e&&(S=t),I===t&&(I=E[nt]),C.insertBefore(t,e)):0<n&&(S===t&&(S=t[et]),e[et]?C.insertBefore(t,e[et]):(C.appendChild(t),I=t)),t[X].index=e[X].index,C.insertBefore(E,t)}function t(t){s&&!m&&w.opts.container&&(ut.test(t.type)&&0!==t.button||(n(),!(e=t.target)||!ft(e,w.opts.handle||"dnd-sortable-handle")||!(T=function(t,e){if(t.closest)return t.closest("."+e);for(;t;){if(ft(t,e))return t;t=t.parentNode}}(e,w.opts.item||"dnd-sortable-item"))||!(C=T.parentNode)||"string"==typeof w.opts.container&&C.id!==w.opts.container||"string"!=typeof w.opts.container&&C!==w.opts.container?n():("function"==typeof w.opts.onStart&&w.opts.onStart(T),"function"!=typeof w.opts.itemFilter||(T=w.opts.itemFilter(T))?(m=!0,$=T.ownerDocument||document,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),h=t.changedTouches&&t.changedTouches.length,function(){var r=0,i=0,a=K,l=U,s=Q,t=(C.tagName||"").toLowerCase();if(N=null,w.opts.autoscroll)for(N=C;N&&!($.scrollingElement===N||at!==y&&N.scrollHeight>N.clientHeight&&St(N,ot)||it!==y&&N.scrollWidth>N.clientWidth&&St(N,rt));)N=N.parentNode;f=wt(C,["width","height","box-sizing"]),d=xt(C),(P=C.getBoundingClientRect())[J]={left:ct(d.paddingLeft)||0,right:ct(d.paddingRight)||0},N&&(N[X]={rect:N.getBoundingClientRect(),scroll:{top:N[ot]||0,left:N[rt]||0,width:N.scrollWidth,height:N.scrollHeight}}),(c=[].map.call(C.children,function(t,e){var n=t.getBoundingClientRect(),o=xt(t);return t[X]={index:e,line:0,prev:{},rect:{top:n[Z],left:n[K],width:n[U],height:n[tt]},r:{top:n[Z],left:n[K],width:n[U],height:n[tt]},margin:{top:ct(o.marginTop)||0,right:ct(o.marginRight)||0,bottom:ct(o.marginBottom)||0,left:ct(o.marginLeft)||0},$:o,style:wt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),animation:null},o=t[X][G][a]+t[X][Y][l]+t[X][G][s],0<i&&P[J][a]+i+o+P[J][s]>P[l]&&(r++,i=0),t[X].line=r,i+=o,t})).length&&(S=c[0],I=c[c.length-1]),a=Z,l=tt,s=_,u=new Array(c.length),c.forEach(function(t){var e=t[X].line,t=t[X][Y][a]-t[X][G][a]-P[a];u[e]=null==u[e]?t:st.min(t,u[e])}),mt(C,w.opts.activeArea||"dnd-sortable-area"),C[q].boxSizing="border-box",C[q][U]=pt(P[U])+"px",C[q][tt]=pt(P[tt])+"px",T.draggable=!1,mt(T,w.opts.activeItem||"dnd-sortable-dragged"),v=!0,c.forEach(function(t){var e=c[0];t[q].position="absolute",t[q].boxSizing="border-box",t[q].overflow="hidden",t[q][Z]=pt(t[X][Y][Z]-P[Z]-t[X][G][Z])+"px",t[q][K]=pt(t[X][Y][K]-P[K]-t[X][G][K])+"px",t[q][U]=pt(t[X][Y][U])+"px",t[q][tt]=pt(t[X][Y][tt])+"px",t[X][Y][U]===e[X][Y][U]&&t[X][Y][tt]===e[X][Y][tt]&&t[X][G][Z]===e[X][G][Z]&&t[X][G][_]===e[X][G][_]&&t[X][G][K]===e[X][G][K]&&t[X][G][Q]===e[X][G][Q]||(v=!1)}),mt(E=$.createElement("ul"===t||"ol"===t?"li":"tr"===t?"td":"tbody"===t||"thead"===t||"tfoot"===t||"table"===t?"tr":"span"),w.opts.placeholder||"dnd-sortable-placeholder"),E[q].position="absolute",E[q].display="block",E[q].boxSizing="border-box",E[q].margin="0",h?(vt($,"touchmove",x,!1),vt($,"touchend",b,!1),vt($,"touchcancel",b,!1)):(vt($,"mousemove",x,!1),vt($,"mouseup",b,!1))}(),A=(h?t.changedTouches[0]:t).clientX,R=(h?t.changedTouches[0]:t).clientY,z=A+P[K]-T[X][Y][K]+T[X][G][K],B=R+P[Z]-T[X][Y][Z]+T[X][G][Z],C.insertBefore(E,T),E[q][U]=pt(T[X][Y][U])+"px",E[q][tt]=pt(T[X][Y][tt])+"px",E[q][Z]=pt(T[X][Y][Z]-P[Z])+"px",E[q][K]=pt(T[X][Y][K]-P[K])+"px",at!==y&&(T[q][Z]=pt(R-B)+"px"),it!==y&&(T[q][K]=pt(A-z)+"px")):n())))}var E,T,e,L,S,I,c,u,N,C,P,d,f,z,B,A,R,j,k,O,W,$,r,i,a,l=!1,s=!1,m=!1,h=!1,D=null,v=!1,F=at===y?U:tt,H=at===y?K:Z,g=K===H?Q:_,M=lt===y?function(t,e,n,o){var r,i,a=e;if(v){if(n<0){for(i=t[et],p(t,e,n),t[X].prev.line=t[X].line,t[X].prev[Z]=t[X][Y][Z],t[X].prev[K]=t[X][Y][K],t[X].line=e[X].line,t[X][Y][Z]=e[X][Y][Z],t[X][Y][K]=e[X][Y][K],E[q][Z]=pt(t[X][Y][Z]-P[Z])+"px",E[q][K]=pt(t[X][Y][K]-P[K])+"px";(r=e[et])&&r!==i;)e[X].animation&&e[X].animation.stop(),e[X].index++,e[X].prev.line=e[X].line,e[X].prev[Z]=e[X][Y][Z],e[X].prev[K]=e[X][Y][K],e[X].line=r[X].line,e[X][Y][Z]=r[X][Y][Z],e[X][Y][K]=r[X][Y][K],e[q][Z]=pt(e[X][Y][Z]-P[Z]-e[X][G][Z])+"px",e[q][K]=pt(e[X][Y][K]-P[K]-e[X][G][K])+"px",e=r;e[X].animation&&e[X].animation.stop(),e[X].index++,e[X].prev.line=e[X].line,e[X].prev[Z]=e[X][Y][Z],e[X].prev[K]=e[X][Y][K],e[X].line=t[X].prev.line,e[X][Y][Z]=t[X].prev[Z],e[X][Y][K]=t[X].prev[K],e[q][Z]=pt(e[X][Y][Z]-P[Z]-e[X][G][Z])+"px",e[q][K]=pt(e[X][Y][K]-P[K]-e[X][G][K])+"px"}else if(0<n){for(i=t[et],p(t,e,n),e=i,(r=t)[X].prev.line=r[X].line,r[X].prev[Z]=r[X][Y][Z],r[X].prev[K]=r[X][Y][K];e[X].animation&&e[X].animation.stop(),e[X].index--,e[X].prev.line=e[X].line,e[X].prev[Z]=e[X][Y][Z],e[X].prev[K]=e[X][Y][K],e[X].line=r[X].prev.line,e[X][Y][Z]=r[X].prev[Z],e[X][Y][K]=r[X].prev[K],e[q][Z]=pt(e[X][Y][Z]-P[Z]-e[X][G][Z])+"px",e[q][K]=pt(e[X][Y][K]-P[K]-e[X][G][K])+"px",(e=(r=e)[et])&&e!==E;);t[X].line=r[X].prev.line,t[X][Y][Z]=r[X].prev[Z],t[X][Y][K]=r[X].prev[K],E[q][Z]=pt(t[X][Y][Z]-P[Z])+"px",E[q][K]=pt(t[X][Y][K]-P[K])+"px"}Et(a,o,{top:a[X][Y][Z]-a[X].prev[Z],left:a[X][Y][K]-a[X].prev[K]})}else n<0?(r=E[nt],i=e[nt]||e,p(t,e,n)):0<n&&(r=t[et],i=E[nt]||t[et],p(t,e,n)),function(t,e,n,o){for(t=t[n<0?et:nt];t;){if(t!==o&&(t[X].index+=n<0?1:-1),t===e)return;t=t[n<0?et:nt]}}(t,r,n,E),function(t,e,n,o,r,i,a,l){for(var s,p=0;t;)t!==r&&(t[X]&&t[X].animation&&t[X].animation.stop(),s=t[X][G][i]+t[X][Y][a]+t[X][G][l],0<p&&n[J][i]+p+s+n[J][l]>n[a]&&(e++,p=0),t[X].line=e,t[X].prev[i]=t[X][Y][i],t[X][Y][i]=n[i]+n[J][i]+p+t[X][G][i],t===o?r[q][i]=pt(t[X][Y][i]-n[i])+"px":t[q][i]=pt(t[X][Y][i]-t[X][G][i]-n[i])+"px",p+=s),t=t[et]}(i=function(t,e){for(var n;(n=t[nt])&&n[X]&&n[X].line>=e;)t=n;return t}(i,n=i[X].line),n,P,t,E,K,U,Q),function(t,e,n,o,r,i,a,l){for(var s,p,c,u=t,d=t[X].line,f=0;t;)t!==r&&(s=t[X].line,c=t[X][G][i]+t[X][Y][a]+t[X][G][l],f=s===d?st.max(f,c):(e[s]=e[d]+f,d=s,c)),t=t[et];for(0<f&&(e[d+1]=e[d]+f),t=u;t;){if(t!==r){switch(p=e[s=t[X].line],t[X].prev[i]=t[X][Y][i],t[X].$.verticalAlign){case"bottom":t[X][Y][i]=n[i]+e[s+1]-t[X][Y][a]-t[X][G][l];break;case"top":default:t[X][Y][i]=n[i]+p+t[X][G][i]}t===o?r[q][i]=pt(t[X][Y][i]-n[i])+"px":t[q][i]=pt(t[X][Y][i]-t[X][G][i]-n[i])+"px"}t=t[et]}}(i,u,P,t,E,Z,tt,_),Et(a,o,{top:a[X][Y][Z]-a[X].prev[Z],left:a[X][Y][K]-a[X].prev[K]})}:function(t,e,n,o){var r,i,a=e,l=0,s=0;if(n<0){for(i=t[et],p(t,e,n),t[X].prev[H]=t[X][Y][H],s=t[X][G][H]-e[X][G][H],t[X][Y][H]=e[X][Y][H]+s,E[q][H]=pt(t[X][Y][H]-P[H])+"px",l=t[X][Y][F]-e[X][Y][F],s+=t[X][G][g]-e[X][G][g];(r=e[et])&&r!==i;)e[X].animation&&e[X].animation.stop(),e[X].index++,e[X].prev[H]=e[X][Y][H],s+=e[X][G][H]-r[X][G][H],e[X][Y][H]=r[X][Y][H]+l+s,s+=e[X][G][g]-r[X][G][g],e[q][H]=pt(e[X][Y][H]-P[H]-e[X][G][H])+"px",l+=e[X][Y][F]-r[X][Y][F],e=r;e[X].animation&&e[X].animation.stop(),e[X].index++,e[X].prev[H]=e[X][Y][H],e[X][Y][H]=t[X].prev[H]+l+s-t[X][G][H]+e[X][G][H],e[q][H]=pt(e[X][Y][H]-P[H]-e[X][G][H])+"px"}else if(0<n){for(i=t[et],p(t,e,n),e=i,l=s=0,(r=t)[X].prev[H]=r[X][Y][H];e[X].animation&&e[X].animation.stop(),e[X].index--,e[X].prev[H]=e[X][Y][H],s+=e[X][G][H]-r[X][G][H],e[X][Y][H]=r[X].prev[H]+l+s,e[q][H]=pt(e[X][Y][H]-P[H]-e[X][G][H])+"px",l+=-(r[X][Y][F]-e[X][Y][F]),s+=e[X][G][g]-r[X][G][g],(e=(r=e)[et])&&e!==E;);t[X][Y][H]=r[X].prev[H]+l+s-r[X][G][H]+t[X][G][H],E[q][H]=pt(t[X][Y][H]-P[H])+"px"}(t={})[H]=a[X][Y][H]-a[X].prev[H],Et(a,o,t)},V=lt===y?Lt:Tt,x=(r=function(t){var e,n,o,r,i,a,l,s,p,c,u,d,f=0,m=Z,h=tt,v=K,g=U,x=0,b=0;it===y&&(v=Z,g=tt),n=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientX,e=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientY,o=n-A,r=e-R,A=n,R=e,j={top:((t=N)?t[ot]-t[X].scroll[Z]:0)||0,left:(t?t[rt]-t[X].scroll[K]:0)||0},at!==y&&(T[q][Z]=pt(e-B+j[Z])+"px",T[X].r[Z]=e-B+P[Z]+T[X][G][Z]),it!==y&&(T[q][K]=pt(n-z+j[K])+"px",T[X].r[K]=n-z+P[K]+T[X][G][K]),w.opts.autoscroll&&N&&!D&&(it!==y&&(0<o&&N[rt]+N[X].rect[U]<N[X].scroll[U]&&T[X].r[K]+T[X].r[U]/2+25>N[X].rect[Q]||o<0&&0<N[rt]&&T[X].r[K]+T[X].r[U]/2-25<N[X].rect[K])&&(x=st.round(1.5*dt(o)*T[X].r[U])),at!==y&&(0<r&&N[ot]+N[X].rect[tt]<N[X].scroll[tt]&&T[X].r[Z]+T[X].r[tt]/2+25>N[X].rect[_]||r<0&&0<N[ot]&&T[X].r[Z]+T[X].r[tt]/2-25<N[X].rect[Z])&&(b=st.round(1.5*dt(r)*T[X].r[tt])),(x||b)&&(i=st.abs(x)>st.abs(b)?x:0,a=st.abs(b)>=st.abs(x)?b:0,l=1e3/60,s=N[ot]||0,p=N[rt]||0,c=0,u=i/800,d=a/800,D=setInterval(function(){s+=d*l,p+=u*l,c+=l,N[ot]=st.max(0,s),N[rt]=st.max(0,p),800<=c&&(clearInterval(D),D=null)},l))),b=T[X].r[K]+T[X].r[U]/2,i=T[X].r[Z]+T[X].r[tt]/2,a=T[X].r[v],b=function(t){for(var e=1,n=arguments;e<n.length;e++)t.push.apply(t,n[e]);return t}(bt($,n,e),it===y?[]:bt($,T[X].r[K]+2,i),it===y?[]:bt($,T[X].r[K]+T[X].r[U]-2,i),at===y?[]:bt($,b,T[X].r[Z]+2),at===y?[]:bt($,b,T[X].r[Z]+T[X].r[tt]-2)).reduce(function(t,e){var n;return e!==T&&e!==E&&e.parentNode===C&&(n=V(T,e,j,H,F),f<n&&(f=n,t=e)),t},null),r=lt===y?(!b&&T!==S&&0<=S[X][Y][v]-j[v]-(a+T[X][Y][g])&&S[X][Y][v]-j[v]-(a+T[X][Y][g])<25&&.7<(f=Tt(T,S,j,m,h))&&(b=S),!b&&T!==I&&0<=a-(I[X][Y][v]-j[v]+I[X][Y][g])&&a-(I[X][Y][v]-j[v]+I[X][Y][g])<25&&.7<(f=Tt(T,I,j,m,h))&&(b=I),b?b[X].index-T[X].index:st.abs(r)>=st.abs(o)?r:o):(!b&&T!==S&&S[X][Y][v]-j[v]>a+T[X][Y][g]&&(b=S),!b&&T!==I&&a>I[X][Y][v]-j[v]+I[X][Y][g]&&(b=I),at===y?o:r),L&&(k<0&&0<r&&O<.5||0<k&&r<0&&O<.5||b&&L!==b&&O<f||!V(T,L,j,H,F))&&(ht(L,w.opts.closestItem||"dnd-sortable-closest"),O=0,L=null),!L&&b&&f&&(L=b,k=0<r?1:-1,O=f,W=!1),L&&((f=f||V(T,L,j,H,F))?.2<(O=f)?(mt(L,w.opts.closestItem||"dnd-sortable-closest"),.5<f&&!W&&(W=!0,M(T,L,k,w.opts.animationMs||0))):ht(L,w.opts.closestItem||"dnd-sortable-closest"):(ht(L,w.opts.closestItem||"dnd-sortable-closest"),O=0,L=null))},a=!(i=60),function(){var t=arguments;a||(r.apply(this,t),a=!0,setTimeout(function(){a=!1},i))}),b=function(t){var e=T;o(),n(),"function"==typeof w.opts.onEnd&&w.opts.onEnd(e)};w.start=w.opts.callable?function(){s||(s=!(l=!1),w.handle=t)}:function(){s||(s=!0,l||(l=!0,vt(document,"touchstart",t,{capture:!0,passive:!1}),vt(document,"mousedown",t,{capture:!0,passive:!1})))},w.stop=function(){w.handle=null,s=!1,l&&(l=!1,gt(document,"touchstart",t,{capture:!0,passive:!1}),gt(document,"mousedown",t,{capture:!0,passive:!1})),o(),n()}}function l(t,e){var n=this;if(!(n instanceof l))return new l(t,e);switch(n.opts=e||{},(t=pt(t)).toLowerCase()){case"unrestricted":a(n,lt);break;case"horizontal":a(n,at);break;case"vertical":a(n,it);break;default:throw new TypeError("AreaSortable invalid sort mode:"+t)}n.start()}return window.Element&&!o.call(window.Element.prototype,X)&&(window.Element.prototype[X]=null),l.VERSION="1.2.0",l.prototype={constructor:l,opts:null,start:null,handle:null,stop:null,dispose:function(){var t=this;return t.stop&&t.stop(),t.opts=null,t.start=null,t.handle=null,t.stop=null,t}},l});