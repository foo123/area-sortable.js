/**
*  area-sortable.js
*  A simple js class to sort elements of an area smoothly using drag-and-drop (desktop and mobile)
*  @VERSION: 1.2.0
*
*  https://github.com/foo123/area-sortable.js
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.AreaSortable=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var M=window.document,V="$areaSortable",X="rect",Y="style",q="margin",G="padding",J="left",K="right",Q="width",U="top",Z="bottom",_="height",tt="nextElementSibling",et="previousElementSibling",nt="scrollTop",ot="scrollLeft",rt=1,it=2,at=rt+it,lt=Math,st=String,ct=parseInt,o=Object.prototype.hasOwnProperty,e=/^\s+|\s+$/g,pt=/mousedown|pointerdown/,n=st.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},r=null;function i(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function ut(t){return t<0?-1:0<t?1:0}function dt(t,e){return t.classList?t.classList.contains(e):-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function ft(t,e){t.classList?t.classList.add(e):dt(t,e)||(t.className=""===t.className?e:t.className+" "+e)}function mt(t,e){t.classList?t.classList.remove(e):t.className=n((" "+t.className+" ").replace(" "+e+" "," "))}function ht(t,e,n,o){null==r&&(r=i()),t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,r?o:"object"==typeof o?!!o.capture:!!o)}function vt(t,e,n,o){null==r&&(r=i()),t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener(e,n,r?o:"object"==typeof o?!!o.capture:!!o)}function gt(t){return("function"==typeof window.getComputedStyle?window.getComputedStyle(t):t.currentStyle)||{}}function xt(t,e){return M.elementsFromPoint(t,e)}function bt(n,t){return t.reduce(function(t,e){return t[e]=n[Y].getPropertyValue(e),t},{})}function wt(e,t,n){n=n||e[V][Y],t.forEach(function(t){o.call(n,t)&&""!==n[t]?e[Y][t]=n[t]:e[Y].removeProperty(t)})}function yt(e,t,n){var o,r,i,a;return 0<t&&(e[V].animation&&e[V].animation.stop(),o="transform "+st(t)+"ms",r="translate3d(0,0,0)",i=null,a=function t(){return i&&clearTimeout(i),i=null,e[V]&&e[V].animation&&t===e[V].animation.stop&&(e[V].animation=null),e[Y].transform===r&&e[Y].transition===o&&(e[Y].transition="none",e[Y].transform="none"),e},e[Y].transition="none",e[Y].transform="translate3d("+st(-(n[J]||0))+"px,"+st(-(n[U]||0))+"px,0)",e.offsetWidth,e[Y].transform=r,e[Y].transition=o,i=setTimeout(a,t),e[V].animation={stop:a}),e}function Et(t,e,n,o,r){t=t[V].r,e=e[V][X];return lt.max(0,lt.min(1,lt.max(0,lt.min(t[o]+t[r],e[o]-n[o]+e[r])-lt.max(t[o],e[o]-n[o]))/lt.min(t[r],e[r])))}function Tt(t,e,n,o,r){var i=t[V].r,a=e[V][X],t=0,e=0,t=lt.max(0,lt.min(i[J]+i[Q],a[J]-n[J]+a[Q])-lt.max(i[J],a[J]-n[J])),e=lt.max(0,lt.min(i[U]+i[_],a[U]-n[U]+a[_])-lt.max(i[U],a[U]-n[U]));return lt.max(0,lt.min(1,t*e/(lt.min(i[Q],a[Q])*lt.min(i[_],a[_]))))}function Lt(t){return{top:(t?t[nt]-t[V].scroll[U]:0)||0,left:(t?t[ot]-t[V].scroll[J]:0)||0}}function a(d,f){function n(){u=p=E=T=y=w=b=x=g=v=e=h=m=null,z=!1,k=0}function o(){B&&(A?(vt(M,"touchmove",F,!1),vt(M,"touchend",D,!1),vt(M,"touchcancel",D,!1)):(vt(M,"mousemove",F,!1),vt(M,"mouseup",D,!1)),m&&m.parentNode&&(m.parentNode.removeChild(m),m[V]=null),b&&(b[V]=null),w[V]=null,mt(w,d.opts.activeArea||"dnd-sortable-area"),wt(w,["width","height","box-sizing"],T),v&&mt(v,d.opts.closestItem||"dnd-sortable-closest"),mt(h,d.opts.activeItem||"dnd-sortable-dragged"),p.forEach(function(t){wt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),t[V]=null}),B=!1)}function c(t,e,n){n<0?(g===e&&(g=t),x===t&&(x=m[et]),w.insertBefore(t,e)):0<n&&(g===t&&(g=t[tt]),e[tt]?w.insertBefore(t,e[tt]):(w.appendChild(t),x=t)),t[V].index=e[V].index,w.insertBefore(m,t)}function t(t){s&&!B&&d.opts.container&&(pt.test(t.type)&&0!==t.button||(n(),!(e=t.target)||!dt(e,d.opts.handle||"dnd-sortable-handle")||!(h=function(t,e){if(t.closest)return t.closest("."+e);for(;t;){if(dt(t,e))return t;t=t.parentNode}}(e,d.opts.item||"dnd-sortable-item"))||!(w=h.parentNode)||"string"==typeof d.opts.container&&w.id!==d.opts.container||"string"!=typeof d.opts.container&&w!==d.opts.container?n():("function"==typeof d.opts.onStart&&d.opts.onStart(h),"function"!=typeof d.opts.itemFilter||(h=d.opts.itemFilter(h))?(B=!0,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),A=t.changedTouches&&t.changedTouches.length,function(){var r=0,i=0,a=J,l=Q,s=K,t=(w.tagName||"").toLowerCase();if(b=null,d.opts.autoscroll)for(b=w;b;){if(it===f){if(b.scrollWidth>b.clientWidth)break}else if(rt===f){if(b.scrollHeight>b.clientHeight)break}else if(b.scrollWidth>b.clientWidth||b.scrollHeight>b.clientHeight)break;b=b.parentNode,M===b&&(b=null)}T=bt(w,["width","height","box-sizing"]),E=gt(w),(y=w.getBoundingClientRect())[G]={left:ct(E.paddingLeft)||0,right:ct(E.paddingRight)||0},b&&(b[V]={rect:b.getBoundingClientRect(),scroll:{top:b[nt]||0,left:b[ot]||0,width:b.scrollWidth,height:b.scrollHeight}}),(p=[].map.call(w.children,function(t,e){var n=t.getBoundingClientRect(),o=gt(t);return t[V]={index:e,line:0,prev:{},rect:{top:n[U],left:n[J],width:n[Q],height:n[_]},r:{top:n[U],left:n[J],width:n[Q],height:n[_]},margin:{top:ct(o.marginTop)||0,right:ct(o.marginRight)||0,bottom:ct(o.marginBottom)||0,left:ct(o.marginLeft)||0},$:o,style:bt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),animation:null},o=t[V][q][a]+t[V][X][l]+t[V][q][s],0<i&&y[G][a]+i+o+y[G][s]>y[l]&&(r++,i=0),t[V].line=r,i+=o,t})).length&&(g=p[0],x=p[p.length-1]),a=U,l=_,s=Z,u=new Array(p.length),p.forEach(function(t){var e=t[V].line,t=t[V][X][a]-t[V][q][a]-y[a];u[e]=null==u[e]?t:lt.min(t,u[e])}),ft(w,d.opts.activeArea||"dnd-sortable-area"),w[Y].boxSizing="border-box",w[Y][Q]=st(y[Q])+"px",w[Y][_]=st(y[_])+"px",h.draggable=!1,ft(h,d.opts.activeItem||"dnd-sortable-dragged"),R=!0,p.forEach(function(t){var e=p[0];t[Y].position="absolute",t[Y].boxSizing="border-box",t[Y].overflow="hidden",t[Y][U]=st(t[V][X][U]-y[U]-t[V][q][U])+"px",t[Y][J]=st(t[V][X][J]-y[J]-t[V][q][J])+"px",t[Y][Q]=st(t[V][X][Q])+"px",t[Y][_]=st(t[V][X][_])+"px",t[V][X][Q]===e[V][X][Q]&&t[V][X][_]===e[V][X][_]&&t[V][q][U]===e[V][q][U]&&t[V][q][Z]===e[V][q][Z]&&t[V][q][J]===e[V][q][J]&&t[V][q][K]===e[V][q][K]||(R=!1)}),ft(m=M.createElement("ul"===t||"ol"===t?"li":"tr"===t?"td":"tbody"===t||"thead"===t||"tfoot"===t||"table"===t?"tr":"span"),d.opts.placeholder||"dnd-sortable-placeholder"),m[Y].position="absolute",m[Y].display="block",m[Y].boxSizing="border-box",m[Y].margin="0",A?(ht(M,"touchmove",F,!1),ht(M,"touchend",D,!1),ht(M,"touchcancel",D,!1)):(ht(M,"mousemove",F,!1),ht(M,"mouseup",D,!1))}(),N=(A?t.changedTouches[0]:t).clientX,I=(A?t.changedTouches[0]:t).clientY,L=N+y[J]-h[V][X][J]+h[V][q][J],S=I+y[U]-h[V][X][U]+h[V][q][U],w.insertBefore(m,h),m[Y][Q]=st(h[V][X][Q])+"px",m[Y][_]=st(h[V][X][_])+"px",m[Y][U]=st(h[V][X][U]-y[U])+"px",m[Y][J]=st(h[V][X][J]-y[J])+"px",0,at===f?(h[Y][U]=st(I-S)+"px",h[Y][J]=st(N-L)+"px"):h[Y][j]=st(it===f?N-L:I-S)+"px"):n())))}var m,h,e,v,g,x,p,u,b,w,y,E,T,L,S,N,I,C,P,k,z,r,i,a,l=!1,s=!1,B=!1,A=!1,R=!1,W=it===f?Q:_,j=it===f?J:U,H=J===j?K:Z,O=at===f?function(t,e,n,o){var r,i,a=e;if(R){if(n<0){for(i=t[tt],c(t,e,n),t[V].prev.line=t[V].line,t[V].prev[U]=t[V][X][U],t[V].prev[J]=t[V][X][J],t[V].line=e[V].line,t[V][X][U]=e[V][X][U],t[V][X][J]=e[V][X][J],m[Y][U]=st(t[V][X][U]-y[U])+"px",m[Y][J]=st(t[V][X][J]-y[J])+"px";(r=e[tt])&&r!==i;)e[V].animation&&e[V].animation.stop(),e[V].index++,e[V].prev.line=e[V].line,e[V].prev[U]=e[V][X][U],e[V].prev[J]=e[V][X][J],e[V].line=r[V].line,e[V][X][U]=r[V][X][U],e[V][X][J]=r[V][X][J],e[Y][U]=st(e[V][X][U]-y[U]-e[V][q][U])+"px",e[Y][J]=st(e[V][X][J]-y[J]-e[V][q][J])+"px",e=r;e[V].animation&&e[V].animation.stop(),e[V].index++,e[V].prev.line=e[V].line,e[V].prev[U]=e[V][X][U],e[V].prev[J]=e[V][X][J],e[V].line=t[V].prev.line,e[V][X][U]=t[V].prev[U],e[V][X][J]=t[V].prev[J],e[Y][U]=st(e[V][X][U]-y[U]-e[V][q][U])+"px",e[Y][J]=st(e[V][X][J]-y[J]-e[V][q][J])+"px"}else if(0<n){for(i=t[tt],c(t,e,n),e=i,(r=t)[V].prev.line=r[V].line,r[V].prev[U]=r[V][X][U],r[V].prev[J]=r[V][X][J];e[V].animation&&e[V].animation.stop(),e[V].index--,e[V].prev.line=e[V].line,e[V].prev[U]=e[V][X][U],e[V].prev[J]=e[V][X][J],e[V].line=r[V].prev.line,e[V][X][U]=r[V].prev[U],e[V][X][J]=r[V].prev[J],e[Y][U]=st(e[V][X][U]-y[U]-e[V][q][U])+"px",e[Y][J]=st(e[V][X][J]-y[J]-e[V][q][J])+"px",(e=(r=e)[tt])&&e!==m;);t[V].line=r[V].prev.line,t[V][X][U]=r[V].prev[U],t[V][X][J]=r[V].prev[J],m[Y][U]=st(t[V][X][U]-y[U])+"px",m[Y][J]=st(t[V][X][J]-y[J])+"px"}yt(a,o,{top:a[V][X][U]-a[V].prev[U],left:a[V][X][J]-a[V].prev[J]})}else n<0?(r=m[et],i=e[et]||e,c(t,e,n)):0<n&&(r=t[tt],i=m[et]||t[tt],c(t,e,n)),function(t,e,n,o){for(t=t[n<0?tt:et];t;){if(t!==o&&(t[V].index+=n<0?1:-1),t===e)return;t=t[n<0?tt:et]}}(t,r,n,m),function(t,e,n,o,r,i,a,l){for(var s,c=0;t;)t!==r&&(t[V]&&t[V].animation&&t[V].animation.stop(),s=t[V][q][i]+t[V][X][a]+t[V][q][l],0<c&&n[G][i]+c+s+n[G][l]>n[a]&&(e++,c=0),t[V].line=e,t[V].prev[i]=t[V][X][i],t[V][X][i]=n[i]+n[G][i]+c+t[V][q][i],t===o?r[Y][i]=st(t[V][X][i]-n[i])+"px":t[Y][i]=st(t[V][X][i]-t[V][q][i]-n[i])+"px",c+=s),t=t[tt]}(i=function(t,e){for(var n;(n=t[et])&&n[V]&&n[V].line>=e;)t=n;return t}(i,n=i[V].line),n,y,t,m,J,Q,K),function(t,e,n,o,r,i,a,l){for(var s,c,p,u=t,d=t[V].line,f=0;t;)t!==r&&(s=t[V].line,p=t[V][q][i]+t[V][X][a]+t[V][q][l],f=s===d?lt.max(f,p):(e[s]=e[d]+f,d=s,p)),t=t[tt];for(0<f&&(e[d+1]=e[d]+f),t=u;t;){if(t!==r){switch(c=e[s=t[V].line],t[V].prev[i]=t[V][X][i],t[V].$.verticalAlign){case"bottom":t[V][X][i]=n[i]+e[s+1]-t[V][X][a]-t[V][q][l];break;case"top":default:t[V][X][i]=n[i]+c+t[V][q][i]}t===o?r[Y][i]=st(t[V][X][i]-n[i])+"px":t[Y][i]=st(t[V][X][i]-t[V][q][i]-n[i])+"px"}t=t[tt]}}(i,u,y,t,m,U,_,Z),yt(a,o,{top:a[V][X][U]-a[V].prev[U],left:a[V][X][J]-a[V].prev[J]})}:function(t,e,n,o){var r,i,a=e,l=0,s=0;if(n<0){for(i=t[tt],c(t,e,n),t[V].prev[j]=t[V][X][j],s=t[V][q][j]-e[V][q][j],t[V][X][j]=e[V][X][j]+s,m[Y][j]=st(t[V][X][j]-y[j])+"px",l=t[V][X][W]-e[V][X][W],s+=t[V][q][H]-e[V][q][H];(r=e[tt])&&r!==i;)e[V].animation&&e[V].animation.stop(),e[V].index++,e[V].prev[j]=e[V][X][j],s+=e[V][q][j]-r[V][q][j],e[V][X][j]=r[V][X][j]+l+s,s+=e[V][q][H]-r[V][q][H],e[Y][j]=st(e[V][X][j]-y[j]-e[V][q][j])+"px",l+=e[V][X][W]-r[V][X][W],e=r;e[V].animation&&e[V].animation.stop(),e[V].index++,e[V].prev[j]=e[V][X][j],e[V][X][j]=t[V].prev[j]+l+s-t[V][q][j]+e[V][q][j],e[Y][j]=st(e[V][X][j]-y[j]-e[V][q][j])+"px"}else if(0<n){for(i=t[tt],c(t,e,n),e=i,l=s=0,(r=t)[V].prev[j]=r[V][X][j];e[V].animation&&e[V].animation.stop(),e[V].index--,e[V].prev[j]=e[V][X][j],s+=e[V][q][j]-r[V][q][j],e[V][X][j]=r[V].prev[j]+l+s,e[Y][j]=st(e[V][X][j]-y[j]-e[V][q][j])+"px",l+=-(r[V][X][W]-e[V][X][W]),s+=e[V][q][H]-r[V][q][H],(e=(r=e)[tt])&&e!==m;);t[V][X][j]=r[V].prev[j]+l+s-r[V][q][j]+t[V][q][j],m[Y][j]=st(t[V][X][j]-y[j])+"px"}(t={})[j]=a[V][X][j]-a[V].prev[j],yt(a,o,t)},$=at===f?Tt:Et,F=(r=function(t){var e,n,o,r,i,a=0,l=U,s=_,c=J,p=Q,u=!1;rt===f&&(c=U,p=_),n=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientX,e=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientY,o=n-N,r=e-I,C=Lt(b),it===f?(h[Y][J]=st(n-L)+"px",h[V].r[J]=n-L-C[J]+y[J]+h[V][q][J]):rt===f?(h[Y][U]=st(e-S)+"px",h[V].r[U]=e-S-C[U]+y[U]+h[V][q][U]):(h[Y][U]=st(e-S)+"px",h[Y][J]=st(n-L)+"px",h[V].r[U]=e-S-C[U]+y[U]+h[V][q][U],h[V].r[J]=n-L-C[J]+y[J]+h[V][q][J]),d.opts.autoscroll&&b&&(it===f?(0<o&&b[ot]+b[V].rect[Q]<b[V].scroll[Q]&&h[V].r[J]+h[V].r[Q]/2+25>b[V].rect[K]||o<0&&0<b[ot]&&h[V].r[J]+h[V].r[Q]/2-25<b[V].rect[J])&&(b[ot]+=ut(o)*h[V].r[Q],u=!0):rt===f?(0<r&&b[nt]+b[V].rect[_]<b[V].scroll[_]&&h[V].r[U]+h[V].r[_]/2+25>b[V].rect[Z]||r<0&&0<b[nt]&&h[V].r[U]+h[V].r[_]/2-25<b[V].rect[U])&&(b[nt]+=ut(r)*h[V].r[_],u=!0):(0<o&&b[ot]+b[V].rect[Q]<b[V].scroll[Q]&&h[V].r[J]+h[V].r[Q]/2+25>b[V].rect[K]||o<0&&0<b[ot]&&h[V].r[J]+h[V].r[Q]/2-25<b[V].rect[J]||0<r&&b[nt]+b[V].rect[_]<b[V].scroll[_]&&h[V].r[U]+h[V].r[_]/2+25>b[V].rect[Z]||r<0&&0<b[nt]&&h[V].r[U]+h[V].r[_]/2-25<b[V].rect[U])&&(b[nt]+=ut(r)*h[V].r[_],b[ot]+=ut(o)*h[V].r[Q],u=!0)),u&&(C=Lt(b),it===f?h[V].r[J]=n-L-C[J]+y[J]+h[V][q][J]:rt===f?h[V].r[U]=e-S-C[U]+y[U]+h[V][q][U]:(h[V].r[U]=e-S-C[U]+y[U]+h[V][q][U],h[V].r[J]=n-L-C[J]+y[J]+h[V][q][J])),i=h[V].r[J]+h[V].r[Q]/2,t=h[V].r[U]+h[V].r[_]/2,u=h[V].r[c],i=xt(n,e).concat(rt===f?[]:xt(h[V].r[J]+2,t)).concat(rt===f?[]:xt(h[V].r[J]+h[V].r[Q]-2,t)).concat(it===f?[]:xt(i,h[V].r[U]+2)).concat(it===f?[]:xt(i,h[V].r[U]+h[V].r[_]-2)).reduce(function(t,e){var n;return e!==h&&e!==m&&e.parentNode===w&&(n=$(h,e,C,j,W),a<n&&(a=n,t=e)),t},null),r=at===f?(!i&&h!==g&&0<=g[V][X][c]-C[c]-(u+h[V][X][p])&&g[V][X][c]-C[c]-(u+h[V][X][p])<25&&.7<(a=Et(h,g,C,l,s))&&(i=g),!i&&h!==x&&0<=u-(x[V][X][c]-C[c]+x[V][X][p])&&u-(x[V][X][c]-C[c]+x[V][X][p])<25&&.7<(a=Et(h,x,C,l,s))&&(i=x),i?i[V].index-h[V].index:lt.abs(r)>=lt.abs(o)?r:o):(!i&&h!==g&&g[V][X][c]-C[c]>u+h[V][X][p]&&(i=g),!i&&h!==x&&u>x[V][X][c]-C[c]+x[V][X][p]&&(i=x),it===f?o:r),v&&(P<0&&0<r&&k<.5||0<P&&r<0&&k<.5||i&&v!==i&&k<a||!$(h,v,C,j,W))&&(mt(v,d.opts.closestItem||"dnd-sortable-closest"),k=0,v=null),!v&&i&&a&&(v=i,P=0<r?1:-1,k=a,z=!1),N=n,I=e,v&&((a=a||$(h,v,C,j,W))?.2<(k=a)?(ft(v,d.opts.closestItem||"dnd-sortable-closest"),.5<a&&!z&&(z=!0,O(h,v,P,d.opts.animationMs||0))):mt(v,d.opts.closestItem||"dnd-sortable-closest"):(mt(v,d.opts.closestItem||"dnd-sortable-closest"),k=0,v=null))},a=!(i=60),function(){var t=arguments;a||(r.apply(this,t),a=!0,setTimeout(function(){a=!1},i))}),D=function(t){var e=h;o(),n(),"function"==typeof d.opts.onEnd&&d.opts.onEnd(e)};d.start=d.opts.callable?function(){s||(s=!(l=!1),d.handle=t)}:function(){s||(s=!0,l||(ht(M,"touchstart",t,{capture:l=!0,passive:!1}),ht(M,"mousedown",t,{capture:!0,passive:!1})))},d.stop=function(){d.handle=null,s=!1,l&&(vt(M,"touchstart",t,{capture:!(l=!1),passive:!1}),vt(M,"mousedown",t,{capture:!0,passive:!1})),o(),n()}}function l(t,e){var n=this;if(!(n instanceof l))return new l(t,e);switch(n.opts=e||{},(t=st(t)).toLowerCase()){case"unrestricted":a(n,at);break;case"horizontal":a(n,it);break;case"vertical":a(n,rt);break;default:throw new TypeError("AreaSortable invalid sort mode:"+t)}n.start()}return window.Element&&!o.call(window.Element.prototype,V)&&(window.Element.prototype[V]=null),l.VERSION="1.2.0",l.prototype={constructor:l,opts:null,start:null,handle:null,stop:null,dispose:function(){var t=this;return t.stop&&t.stop(),t.opts=null,t.start=null,t.handle=null,t.stop=null,t}},l});