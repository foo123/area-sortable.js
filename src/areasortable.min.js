/**
*  area-sortable.js
*  A simple js class to sort elements of an area using drag-and-drop (desktop and mobile)
*  @VERSION: 1.0.0
*
*  https://github.com/foo123/area-sortable.js
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.AreaSortable=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var O="$dndSortable",R=1,A=2,j=R+A,k=Math,M=String,o=Object.prototype.hasOwnProperty,e=/^\s+|\s+$/g,n=M.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")};function V(t,e){return t.classList?t.classList.contains(e):-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function X(t,e){t.classList?t.classList.add(e):V(t,e)||(t.className=""===t.className?e:t.className+" "+e)}function Y(t,e){t.classList?t.classList.remove(e):t.className=n((" "+t.className+" ").replace(" "+e+" "," "))}function $(t,e,n,o){t=t[O].r,e=e[O].rect;return k.max(0,k.min(1,k.max(0,k.min(t[n]+t[o],e[n]+e[o])-k.max(t[n],e[n]))/k.min(t[o],e[o])))}function D(t,e,n,o){var r=t[O].r,i=e[O].rect,t=0,e=0,t=k.max(0,k.min(r.left+r.width,i.left+i.width)-k.max(r.left,i.left)),e=k.max(0,k.min(r.top+r.height,i.top+i.height)-k.max(r.top,i.top));return k.max(0,k.min(1,t*e/(k.min(r.width,i.width)*k.min(r.height,i.height))))}function F(n,t){return t.reduce(function(t,e){return t[e]=n.style.getPropertyValue(e),t},{})}function W(e,t,n){n=n||e[O].style,t.forEach(function(t){o.call(n,t)&&""!==n[t]?e.style[t]=n[t]:e.style.removeProperty(t)})}function q(t,e,n){var o,r,i;0<e&&(t.style.transition="none",t.style.transform="translate3d("+M(-(n.left||0))+"px,"+M(-(n.top||0))+"px,0)",t.offsetWidth,o="all "+M(e)+"ms",r="translate3d(0,0,0)",t.style.transform=r,t.style.transition=o,n=function(){return i&&clearTimeout(i),i=null,t.style.transition===o&&(t.style.transition="none"),t.style.transform===r&&(t.style.transform="none"),t[O].animation=null,t},i=setTimeout(n,e),t[O].animation={stop:n})}function r(p,a){function n(){i=v=r=h=m=u=f=e=d=null,S=!1,w=0}function t(t){L||/mousedown|pointerdown/.test(t.type)&&0!==t.button||(n(),(e=t.target)&&V(e,p.opts.handle||"dnd-sortable-handle")&&(d=e.closest("."+(p.opts.item||"dnd-sortable-item")))&&(h=d.parentNode)&&h.id===p.opts.container?(L=!0,t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),v=h.getBoundingClientRect(),i=F(h,["width","height","box-sizing"]),(r=[].map.call(h.children,function(t,e){var n=t.getBoundingClientRect();return t[O]={index:e,rect:{top:n.top,left:n.left,width:n.width,height:n.height,prev:{}},style:F(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"])},t})).length&&(u=r[0],m=r[r.length-1]),X(h,p.opts.activeArea||"dnd-sortable-area"),h.style.boxSizing="border-box",h.style.width=M(v.width)+"px",h.style.height=M(v.height)+"px",d.draggable=!1,X(d,p.opts.activeItem||"dnd-sortable-dragged"),r.forEach(function(t){t.style.position="absolute",t.style.boxSizing="border-box",t.style.overflow="hidden",t.style.top=M(t[O].rect.top-v.top)+"px",t.style.left=M(t[O].rect.left-v.left)+"px",t.style.width=M(t[O].rect.width)+"px",t.style.height=M(t[O].rect.height)+"px"}),"function"==typeof p.opts.onStart&&p.opts.onStart(d),y=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientX,b=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientY,g=y+v.left-d[O].rect.left,x=b+v.top-d[O].rect.top,j===a?(d.style.top=M(b-x)+"px",d.style.left=M(y-g)+"px"):d.style[N]=M(A===a?y-g:b-x)+"px",document.addEventListener("touchmove",B,!1),document.addEventListener("touchend",C,!1),document.addEventListener("touchcancel",C,!1),document.addEventListener("mousemove",B,!1),document.addEventListener("mouseup",C,!1)):n())}function o(){L&&(document.removeEventListener("touchmove",B,!1),document.removeEventListener("touchend",C,!1),document.removeEventListener("touchcancel",C,!1),document.removeEventListener("mousemove",B,!1),document.removeEventListener("mouseup",C,!1),Y(h,p.opts.activeArea||"dnd-sortable-area"),W(h,["width","height","box-sizing"],i),f&&Y(f,p.opts.closestItem||"dnd-sortable-closest"),Y(d,p.opts.activeItem||"dnd-sortable-dragged"),r.forEach(function(t){W(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),t[O]=null}),L=!1)}var d,e,f,u,m,h,r,v,i,g,x,y,b,E,w,S,c,s,l,L=!1,T=!1,I=A===a?"width":"height",N=A===a?"left":"top",P=j===a?function(t,e,n,o){var r,i,c=e;if(u!==m)if(n<0){for(i=t.nextElementSibling,u===e&&(u=t),m===t&&(m=t.previousElementSibling),h.insertBefore(t,e),t[O].index=e[O].index,t[O].rect.prev.top=t[O].rect.top,t[O].rect.prev.left=t[O].rect.left,t[O].rect.top=e[O].rect.top,t[O].rect.left=e[O].rect.left;(r=e.nextElementSibling)&&r!==i;)e[O].animation&&e[O].animation.stop(),e[O].index++,e[O].rect.prev.top=e[O].rect.top,e[O].rect.prev.left=e[O].rect.left,e[O].rect.top=r[O].rect.top,e[O].rect.left=r[O].rect.left,e.style.top=M(e[O].rect.top-v.top)+"px",e.style.left=M(e[O].rect.left-v.left)+"px",e=r;e[O].animation&&e[O].animation.stop(),e[O].index++,e[O].rect.prev.top=e[O].rect.top,e[O].rect.prev.left=e[O].rect.left,e[O].rect.top=t[O].rect.prev.top,e[O].rect.left=t[O].rect.prev.left,e.style.top=M(e[O].rect.top-v.top)+"px",e.style.left=M(e[O].rect.left-v.left)+"px",q(c,o,{top:c[O].rect.top-c[O].rect.prev.top,left:c[O].rect.left-c[O].rect.prev.left})}else if(0<n){for(i=t.nextElementSibling,u===t&&(u=i),e.nextElementSibling?h.insertBefore(t,e.nextElementSibling):(h.appendChild(t),m=t),t[O].index=e[O].index,e=i,(r=t)[O].rect.prev.top=r[O].rect.top,r[O].rect.prev.left=r[O].rect.left;e[O].animation&&e[O].animation.stop(),e[O].index--,e[O].rect.prev.top=e[O].rect.top,e[O].rect.prev.left=e[O].rect.left,e[O].rect.top=r[O].rect.prev.top,e[O].rect.left=r[O].rect.prev.left,e.style.top=M(e[O].rect.top-v.top)+"px",e.style.left=M(e[O].rect.left-v.left)+"px",(e=(r=e).nextElementSibling)&&e!==t;);t[O].rect.top=r[O].rect.prev.top,t[O].rect.left=r[O].rect.prev.left,q(c,o,{top:c[O].rect.top-c[O].rect.prev.top,left:c[O].rect.left-c[O].rect.prev.left})}}:function(t,e,n,o){var r,i,c,s=e,l=0;if(u!==m)if(n<0){for(i=t.nextElementSibling,u===e&&(u=t),m===t&&(m=t.previousElementSibling),h.insertBefore(t,e),t[O].index=e[O].index,t[O].rect.prev[N]=t[O].rect[N],t[O].rect[N]=e[O].rect[N],l=t[O].rect[I]-e[O].rect[I];(r=e.nextElementSibling)&&r!==i;)e[O].animation&&e[O].animation.stop(),e[O].index++,e[O].rect.prev[N]=e[O].rect[N],e[O].rect[N]=r[O].rect[N]+l,e.style[N]=M(e[O].rect[N]-v[N])+"px",l+=e[O].rect[I]-r[O].rect[I],e=r;e[O].animation&&e[O].animation.stop(),e[O].index++,e[O].rect.prev[N]=e[O].rect[N],e[O].rect[N]=t[O].rect.prev[N]+l,e.style[N]=M(e[O].rect[N]-v[N])+"px",(c={})[N]=s[O].rect[N]-s[O].rect.prev[N],q(s,o,c)}else if(0<n){for(i=t.nextElementSibling,u===t&&(u=i),e.nextElementSibling?h.insertBefore(t,e.nextElementSibling):(h.appendChild(t),m=t),t[O].index=e[O].index,e=i,l=0,(r=t)[O].rect.prev[N]=r[O].rect[N];e[O].animation&&e[O].animation.stop(),e[O].index--,e[O].rect.prev[N]=e[O].rect[N],e[O].rect[N]=r[O].rect.prev[N]+l,e.style[N]=M(e[O].rect[N]-v[N])+"px",l+=-(r[O].rect[I]-e[O].rect[I]),(e=(r=e).nextElementSibling)&&e!==t;);t[O].rect[N]=r[O].rect.prev[N]+l,(c={})[N]=s[O].rect[N]-s[O].rect.prev[N],q(s,o,c)}},z=j===a?D:$,B=(c=function(t){var e,n,o,r,i,c=0,s="left",l="width";R===a&&(s="top",l="height"),o=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientX,n=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientY,r=o-y,i=n-b,d[O].r=d.getBoundingClientRect(),e=document.elementsFromPoint(o,n).reduce(function(t,e){var n;return e!==d&&e.parentNode===h&&(n=z(d,e,N,I),c<n&&(c=n,t=e)),t},null),t=d[O].r[s],i=j===a?(!e&&d!==u&&0<=u[O].rect[s]-(t+d[O].rect[l])&&u[O].rect[s]-(t+d[O].rect[l])<50&&.7<(c=$(d,u,"top","height"))&&(e=u),!e&&d!==m&&0<=t-(m[O].rect[s]+m[O].rect[l])&&t-(m[O].rect[s]+m[O].rect[l])<50&&.7<(c=$(d,m,"top","height"))&&(e=m),d.style.top=M(n-x)+"px",d.style.left=M(o-g)+"px",e?e[O].index-d[O].index:k.abs(i)>=k.abs(r)?i:r):(!e&&d!==u&&u[O].rect[s]>t+d[O].rect[l]&&(e=u),!e&&d!==m&&t>m[O].rect[s]+m[O].rect[l]&&(e=m),A===a?(d.style[N]=M(o-g)+"px",r):(d.style[N]=M(n-x)+"px",i)),f&&(E<0&&0<i&&w<.5||0<E&&i<0&&w<.5||e&&f!==e&&w<c||!z(d,f,N,I))&&(Y(f,p.opts.closestItem||"dnd-sortable-closest"),w=0,f=null),!f&&e&&c&&(f=e,E=0<i?1:-1,w=c,S=!1),y=o,b=n,f&&((c=c||z(d,f,N,I))?.3<=(w=c)?(X(f,p.opts.closestItem||"dnd-sortable-closest"),.5<c&&!S&&(S=!0,P(d,f,E,p.opts.animationMs))):Y(f,p.opts.closestItem||"dnd-sortable-closest"):(Y(f,p.opts.closestItem||"dnd-sortable-closest"),w=0,f=null))},l=!(s=60),function(){var t=arguments;l||(c.apply(this,t),l=!0,setTimeout(function(){l=!1},s))}),C=function(t){var e=d;o(),n(),"function"==typeof p.opts.onEnd&&p.opts.onEnd(e)};p.start=function(){T||(T=!0,n(),document.addEventListener("touchstart",t,!0),document.addEventListener("mousedown",t,!0))},p.stop=function(){T&&(T=!1,document.removeEventListener("touchstart",t,!0),document.removeEventListener("mousedown",t,!0),o(),n())}}function i(t,e){var n=this;if(!(n instanceof i))return new i(t,e);switch(n.opts=e||{},M(t||"vertical").toLowerCase()){case"unrestricted":r(n,j);break;case"horizontal":r(n,A);break;default:r(n,R)}n.start()}return window.Element&&!o.call(window.Element.prototype,O)&&(window.Element.prototype[O]=null),i.VERSION="1.0.0",i.prototype={constructor:i,opts:null,start:null,stop:null,dispose:function(){var t=this;return t.stop&&t.stop(),t.opts=null,t.start=null,t.stop=null,t}},i});