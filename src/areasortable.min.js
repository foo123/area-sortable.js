/**
*  area-sortable.js
*  A simple js class to sort elements of an area smoothly using drag-and-drop (desktop and mobile)
*  @VERSION: 1.1.0
*
*  https://github.com/foo123/area-sortable.js
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.AreaSortable=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var X=window.document,Y="$areaSortable",W="rect",q="style",G="margin",H="padding",J="left",K="right",Q="width",U="top",Z="bottom",_="height",tt="nextElementSibling",s="previousElementSibling",et=1,nt=2,ot=et+nt,it=Math,rt=String,at=parseInt,o=Object.prototype.hasOwnProperty,e=/^\s+|\s+$/g,st=/mousedown|pointerdown/,n=rt.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function r(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function lt(t,e){return t.classList?t.classList.contains(e):-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function pt(t,e){t.classList?t.classList.add(e):lt(t,e)||(t.className=""===t.className?e:t.className+" "+e)}function ct(t,e){t.classList?t.classList.remove(e):t.className=n((" "+t.className+" ").replace(" "+e+" "," "))}function ut(t,e,n,o){null==i&&(i=r()),t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,i?o:"object"==typeof o?!!o.capture:!!o)}function l(t,e,n,o){null==i&&(i=r()),t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener(e,n,i?o:"object"==typeof o?!!o.capture:!!o)}function dt(t){return("function"==typeof window.getComputedStyle?window.getComputedStyle(t):t.currentStyle)||{}}function ft(t,e){return X.elementsFromPoint(t,e)}function mt(n,t){return t.reduce(function(t,e){return t[e]=n[q].getPropertyValue(e),t},{})}function vt(e,t,n){n=n||e[Y][q],t.forEach(function(t){o.call(n,t)&&""!==n[t]?e[q][t]=n[t]:e[q].removeProperty(t)})}function ht(e,t,n){var o,i,r,a;return 0<t&&(e[Y].animation&&e[Y].animation.stop(),o="transform "+rt(t)+"ms",i="translate3d(0,0,0)",r=null,a=function t(){return r&&clearTimeout(r),r=null,e[Y]&&e[Y].animation&&t===e[Y].animation.stop&&(e[Y].animation=null),e[q].transform===i&&e[q].transition===o&&(e[q].transition="none",e[q].transform="none"),e},e[q].transition="none",e[q].transform="translate3d("+rt(-(n[J]||0))+"px,"+rt(-(n[U]||0))+"px,0)",e.offsetWidth,e[q].transform=i,e[q].transition=o,r=setTimeout(a,t),e[Y].animation={stop:a}),e}function xt(t,e,n,o){t=t[Y].r,e=e[Y][W];return it.max(0,it.min(1,it.max(0,it.min(t[n]+t[o],e[n]+e[o])-it.max(t[n],e[n]))/it.min(t[o],e[o])))}function gt(t,e,n,o){var i=t[Y].r,r=e[Y][W],t=0,e=0,t=it.max(0,it.min(i[J]+i[Q],r[J]+r[Q])-it.max(i[J],r[J])),e=it.max(0,it.min(i[U]+i[_],r[U]+r[_])-it.max(i[U],r[U]));return it.max(0,it.min(1,t*e/(it.min(i[Q],r[Q])*it.min(i[_],r[_]))))}function a(d,f){function n(){w=u=E=S=y=b=g=x=h=c=v=m=null,C=!1,z=0}function o(){A&&(j?(l(X,"touchmove",M,!1),l(X,"touchend",V,!1),l(X,"touchcancel",V,!1)):(l(X,"mousemove",M,!1),l(X,"mouseup",V,!1)),m&&m.parentNode&&m.parentNode.removeChild(m),ct(b,d.opts.activeArea||"dnd-sortable-area"),vt(b,["width","height","box-sizing"],S),h&&ct(h,d.opts.closestItem||"dnd-sortable-closest"),ct(v,d.opts.activeItem||"dnd-sortable-dragged"),u.forEach(function(t){vt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),t[Y]=null}),A=!1)}function p(t,e,n){n<0?(x===e&&(x=t),g===t&&(g=m[s]),b.insertBefore(t,e)):0<n&&(x===t&&(x=t[tt]),e[tt]?b.insertBefore(t,e[tt]):(b.appendChild(t),g=t)),t[Y].index=e[Y].index,b.insertBefore(m,t)}function t(t){var i,r,a,s,l,e;B&&!A&&d.opts.container&&(st.test(t.type)&&0!==t.button||(n(),!(c=t.target)||!lt(c,d.opts.handle||"dnd-sortable-handle")||!(v=function(t,e){if(t.closest)return t.closest("."+e);for(;t;){if(lt(t,e))return t;t=t.parentNode}}(c,d.opts.item||"dnd-sortable-item"))||!(b=v.parentNode)||"string"==typeof d.opts.container&&b.id!==d.opts.container||"string"!=typeof d.opts.container&&b!==d.opts.container?n():("function"==typeof d.opts.onStart&&d.opts.onStart(v),"function"!=typeof d.opts.itemFilter||(v=d.opts.itemFilter(v))?(A=!0,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),j=t.changedTouches&&t.changedTouches.length,r=i=0,a=J,s=Q,l=K,e=(b.tagName||"").toLowerCase(),S=mt(b,["width","height","box-sizing"]),E=dt(b),(y=b.getBoundingClientRect())[H]={left:at(E.paddingLeft)||0,right:at(E.paddingRight)||0},(u=[].map.call(b.children,function(t,e){var n=t.getBoundingClientRect(),o=dt(t);return t[Y]={index:e,line:0,prev:{},rect:{top:n[U],left:n[J],width:n[Q],height:n[_]},r:{top:n[U],left:n[J],width:n[Q],height:n[_]},margin:{top:at(o.marginTop)||0,right:at(o.marginRight)||0,bottom:at(o.marginBottom)||0,left:at(o.marginLeft)||0},$:o,style:mt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),animation:null},o=t[Y][G][a]+t[Y][W][s]+t[Y][G][l],0<r&&y[H][a]+r+o+y[H][l]>y[s]&&(i++,r=0),t[Y].line=i,r+=o,t})).length&&(x=u[0],g=u[u.length-1]),a=U,s=_,l=Z,w=new Array(u.length),u.forEach(function(t){var e=t[Y].line,t=t[Y][W][a]-t[Y][G][a]-y[a];w[e]=null==w[e]?t:it.min(t,w[e])}),pt(b,d.opts.activeArea||"dnd-sortable-area"),b[q].boxSizing="border-box",b[q][Q]=rt(y[Q])+"px",b[q][_]=rt(y[_])+"px",v.draggable=!1,pt(v,d.opts.activeItem||"dnd-sortable-dragged"),k=!0,u.forEach(function(t){var e=u[0];t[q].position="absolute",t[q].boxSizing="border-box",t[q].overflow="hidden",t[q][U]=rt(t[Y][W][U]-y[U]-t[Y][G][U])+"px",t[q][J]=rt(t[Y][W][J]-y[J]-t[Y][G][J])+"px",t[q][Q]=rt(t[Y][W][Q])+"px",t[q][_]=rt(t[Y][W][_])+"px",t[Y][W][Q]===e[Y][W][Q]&&t[Y][W][_]===e[Y][W][_]&&t[Y][G][U]===e[Y][G][U]&&t[Y][G][Z]===e[Y][G][Z]&&t[Y][G][J]===e[Y][G][J]&&t[Y][G][K]===e[Y][G][K]||(k=!1)}),pt(m=X.createElement("ul"===e||"ol"===e?"li":"tr"===e?"td":"tbody"===e||"thead"===e||"tfoot"===e||"table"===e?"tr":"span"),d.opts.placeholder||"dnd-sortable-placeholder"),m[q].position="absolute",m[q].display="block",m[q].boxSizing="border-box",m[q].margin="0",j?(ut(X,"touchmove",M,!1),ut(X,"touchend",V,!1),ut(X,"touchcancel",V,!1)):(ut(X,"mousemove",M,!1),ut(X,"mouseup",V,!1)),N=(j?t.changedTouches[0]:t).clientX,I=(j?t.changedTouches[0]:t).clientY,T=N+y[J]-v[Y][W][J]+v[Y][G][J],L=I+y[U]-v[Y][W][U]+v[Y][G][U],b.insertBefore(m,v),m[q][Q]=rt(v[Y][W][Q])+"px",m[q][_]=rt(v[Y][W][_])+"px",m[q][U]=rt(v[Y][W][U]-y[U])+"px",m[q][J]=rt(v[Y][W][J]-y[J])+"px",ot===f?(v[q][U]=rt(I-L)+"px",v[q][J]=rt(N-T)+"px"):v[q][R]=rt(nt===f?N-T:I-L)+"px"):n())))}var m,v,c,h,x,g,b,u,w,y,E,S,T,L,N,I,P,z,C,e,i,r,a=!1,B=!1,A=!1,j=!1,k=!1,O=nt===f?Q:_,R=nt===f?J:U,$=J===R?K:Z,F=ot===f?function(t,e,n,o){var i,r,a=e;if(k){if(n<0){for(r=t[tt],p(t,e,n),t[Y].prev.line=t[Y].line,t[Y].prev[U]=t[Y][W][U],t[Y].prev[J]=t[Y][W][J],t[Y].line=e[Y].line,t[Y][W][U]=e[Y][W][U],t[Y][W][J]=e[Y][W][J],m[q][U]=rt(t[Y][W][U]-y[U])+"px",m[q][J]=rt(t[Y][W][J]-y[J])+"px";(i=e[tt])&&i!==r;)e[Y].animation&&e[Y].animation.stop(),e[Y].index++,e[Y].prev.line=e[Y].line,e[Y].prev[U]=e[Y][W][U],e[Y].prev[J]=e[Y][W][J],e[Y].line=i[Y].line,e[Y][W][U]=i[Y][W][U],e[Y][W][J]=i[Y][W][J],e[q][U]=rt(e[Y][W][U]-y[U]-e[Y][G][U])+"px",e[q][J]=rt(e[Y][W][J]-y[J]-e[Y][G][J])+"px",e=i;e[Y].animation&&e[Y].animation.stop(),e[Y].index++,e[Y].prev.line=e[Y].line,e[Y].prev[U]=e[Y][W][U],e[Y].prev[J]=e[Y][W][J],e[Y].line=t[Y].prev.line,e[Y][W][U]=t[Y].prev[U],e[Y][W][J]=t[Y].prev[J],e[q][U]=rt(e[Y][W][U]-y[U]-e[Y][G][U])+"px",e[q][J]=rt(e[Y][W][J]-y[J]-e[Y][G][J])+"px"}else if(0<n){for(r=t[tt],p(t,e,n),e=r,(i=t)[Y].prev.line=i[Y].line,i[Y].prev[U]=i[Y][W][U],i[Y].prev[J]=i[Y][W][J];e[Y].animation&&e[Y].animation.stop(),e[Y].index--,e[Y].prev.line=e[Y].line,e[Y].prev[U]=e[Y][W][U],e[Y].prev[J]=e[Y][W][J],e[Y].line=i[Y].prev.line,e[Y][W][U]=i[Y].prev[U],e[Y][W][J]=i[Y].prev[J],e[q][U]=rt(e[Y][W][U]-y[U]-e[Y][G][U])+"px",e[q][J]=rt(e[Y][W][J]-y[J]-e[Y][G][J])+"px",(e=(i=e)[tt])&&e!==m;);t[Y].line=i[Y].prev.line,t[Y][W][U]=i[Y].prev[U],t[Y][W][J]=i[Y].prev[J],m[q][U]=rt(t[Y][W][U]-y[U])+"px",m[q][J]=rt(t[Y][W][J]-y[J])+"px"}ht(a,o,{top:a[Y][W][U]-a[Y].prev[U],left:a[Y][W][J]-a[Y].prev[J]})}else n<0?(i=m[s],r=e[s]||e,p(t,e,n)):0<n&&(i=t[tt],r=m[s]||t[tt],p(t,e,n)),function(t,e,n,o){for(t=t[n<0?tt:s];t;){if(t!==o&&(t[Y].index+=n<0?1:-1),t===e)return;t=t[n<0?tt:s]}}(t,i,n,m),function(t,e,n,o,i,r,a,s){for(var l,p=0;t;)t!==i&&(t[Y]&&t[Y].animation&&t[Y].animation.stop(),l=t[Y][G][r]+t[Y][W][a]+t[Y][G][s],0<p&&n[H][r]+p+l+n[H][s]>n[a]&&(e++,p=0),t[Y].line=e,t[Y].prev[r]=t[Y][W][r],t[Y][W][r]=n[r]+n[H][r]+p+t[Y][G][r],t===o?i[q][r]=rt(t[Y][W][r]-n[r])+"px":t[q][r]=rt(t[Y][W][r]-t[Y][G][r]-n[r])+"px",p+=l),t=t[tt]}(r=function(t,e){for(var n;(n=t[s])&&n[Y]&&n[Y].line>=e;)t=n;return t}(r,n=r[Y].line),n,y,t,m,J,Q,K),function(t,e,n,o,i,r,a,s){for(var l,p,c,u=t,d=t[Y].line,f=0;t;)t!==i&&(l=t[Y].line,c=t[Y][G][r]+t[Y][W][a]+t[Y][G][s],f=l===d?it.max(f,c):(e[l]=e[d]+f,d=l,c)),t=t[tt];for(0<f&&(e[d+1]=e[d]+f),t=u;t;){if(t!==i){switch(p=e[l=t[Y].line],t[Y].prev[r]=t[Y][W][r],t[Y].$.verticalAlign){case"bottom":t[Y][W][r]=n[r]+e[l+1]-t[Y][W][a]-t[Y][G][s];break;case"top":default:t[Y][W][r]=n[r]+p+t[Y][G][r]}t===o?i[q][r]=rt(t[Y][W][r]-n[r])+"px":t[q][r]=rt(t[Y][W][r]-t[Y][G][r]-n[r])+"px"}t=t[tt]}}(r,w,y,t,m,U,_,Z),ht(a,o,{top:a[Y][W][U]-a[Y].prev[U],left:a[Y][W][J]-a[Y].prev[J]})}:function(t,e,n,o){var i,r,a=e,s=0,l=0;if(n<0){for(r=t[tt],p(t,e,n),t[Y].prev[R]=t[Y][W][R],l=t[Y][G][R]-e[Y][G][R],t[Y][W][R]=e[Y][W][R]+l,m[q][R]=rt(t[Y][W][R]-y[R])+"px",s=t[Y][W][O]-e[Y][W][O],l+=t[Y][G][$]-e[Y][G][$];(i=e[tt])&&i!==r;)e[Y].animation&&e[Y].animation.stop(),e[Y].index++,e[Y].prev[R]=e[Y][W][R],l+=e[Y][G][R]-i[Y][G][R],e[Y][W][R]=i[Y][W][R]+s+l,l+=e[Y][G][$]-i[Y][G][$],e[q][R]=rt(e[Y][W][R]-y[R]-e[Y][G][R])+"px",s+=e[Y][W][O]-i[Y][W][O],e=i;e[Y].animation&&e[Y].animation.stop(),e[Y].index++,e[Y].prev[R]=e[Y][W][R],e[Y][W][R]=t[Y].prev[R]+s+l-t[Y][G][R]+e[Y][G][R],e[q][R]=rt(e[Y][W][R]-y[R]-e[Y][G][R])+"px"}else if(0<n){for(r=t[tt],p(t,e,n),e=r,s=l=0,(i=t)[Y].prev[R]=i[Y][W][R];e[Y].animation&&e[Y].animation.stop(),e[Y].index--,e[Y].prev[R]=e[Y][W][R],l+=e[Y][G][R]-i[Y][G][R],e[Y][W][R]=i[Y].prev[R]+s+l,e[q][R]=rt(e[Y][W][R]-y[R]-e[Y][G][R])+"px",s+=-(i[Y][W][O]-e[Y][W][O]),l+=e[Y][G][$]-i[Y][G][$],(e=(i=e)[tt])&&e!==m;);t[Y][W][R]=i[Y].prev[R]+s+l-i[Y][G][R]+t[Y][G][R],m[q][R]=rt(t[Y][W][R]-y[R])+"px"}(t={})[R]=a[Y][W][R]-a[Y].prev[R],ht(a,o,t)},D=ot===f?gt:xt,M=(e=function(t){var e,n,o,i,r,a,s=0,l=U,p=_,c=J,u=Q;et===f&&(c=U,u=_),n=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientX,e=(t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).clientY,o=n-N,i=e-I,v[Y].r[U]=e-L+y[U]+v[Y][G][U],v[Y].r[J]=n-T+y[J]+v[Y][G][J],r=v[Y].r[J]+v[Y].r[Q]/2,a=v[Y].r[U]+v[Y].r[_]/2,t=v[Y].r[c],r=ft(n,e).concat(et===f?[]:ft(v[Y].r[J]+2,a)).concat(et===f?[]:ft(v[Y].r[J]+v[Y].r[Q]-2,a)).concat(nt===f?[]:ft(r,v[Y].r[U]+2)).concat(nt===f?[]:ft(r,v[Y].r[U]+v[Y].r[_]-2)).reduce(function(t,e){var n;return e!==v&&e!==m&&e.parentNode===b&&(n=D(v,e,R,O),s<n&&(s=n,t=e)),t},null),i=ot===f?(!r&&v!==x&&0<=x[Y][W][c]-(t+v[Y][W][u])&&x[Y][W][c]-(t+v[Y][W][u])<50&&.7<(s=xt(v,x,l,p))&&(r=x),!r&&v!==g&&0<=t-(g[Y][W][c]+g[Y][W][u])&&t-(g[Y][W][c]+g[Y][W][u])<50&&.7<(s=xt(v,g,l,p))&&(r=g),v[q][U]=rt(e-L)+"px",v[q][J]=rt(n-T)+"px",r?r[Y].index-v[Y].index:it.abs(i)>=it.abs(o)?i:o):(!r&&v!==x&&x[Y][W][c]>t+v[Y][W][u]&&(r=x),!r&&v!==g&&t>g[Y][W][c]+g[Y][W][u]&&(r=g),nt===f?(v[q][R]=rt(n-T)+"px",o):(v[q][R]=rt(e-L)+"px",i)),h&&(P<0&&0<i&&z<.5||0<P&&i<0&&z<.5||r&&h!==r&&z<s||!D(v,h,R,O))&&(ct(h,d.opts.closestItem||"dnd-sortable-closest"),z=0,h=null),!h&&r&&s&&(h=r,P=0<i?1:-1,z=s,C=!1),N=n,I=e,h&&((s=s||D(v,h,R,O))?.2<(z=s)?(pt(h,d.opts.closestItem||"dnd-sortable-closest"),.5<s&&!C&&(C=!0,F(v,h,P,d.opts.animationMs||0))):ct(h,d.opts.closestItem||"dnd-sortable-closest"):(ct(h,d.opts.closestItem||"dnd-sortable-closest"),z=0,h=null))},r=!(i=60),function(){var t=arguments;r||(e.apply(this,t),r=!0,setTimeout(function(){r=!1},i))}),V=function(t){var e=v;o(),n(),"function"==typeof d.opts.onEnd&&d.opts.onEnd(e)};d.start=d.opts.callable?function(){B||(B=!(a=!1),d.handle=t)}:function(){B||(B=!0,a||(ut(X,"touchstart",t,{capture:a=!0,passive:!1}),ut(X,"mousedown",t,{capture:!0,passive:!1})))},d.stop=function(){d.handle=null,B=!1,a&&(l(X,"touchstart",t,{capture:!(a=!1),passive:!1}),l(X,"mousedown",t,{capture:!0,passive:!1})),o(),n()}}function p(t,e){var n=this;if(!(n instanceof p))return new p(t,e);switch(n.opts=e||{},(t=rt(t)).toLowerCase()){case"unrestricted":a(n,ot);break;case"horizontal":a(n,nt);break;case"vertical":a(n,et);break;default:throw new TypeError("AreaSortable invalid sort mode:"+t)}n.start()}return window.Element&&!o.call(window.Element.prototype,Y)&&(window.Element.prototype[Y]=null),p.VERSION="1.1.0",p.prototype={constructor:p,opts:null,start:null,handle:null,stop:null,dispose:function(){var t=this;return t.stop&&t.stop(),t.opts=null,t.start=null,t.handle=null,t.stop=null,t}},p});